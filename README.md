```
                  ,▄██▄▄                                                      ,╔╗╔╗╔╗,
                  ╫███████▄▄                                               ,╔╗╫╫╫╫╫╫╫╫
                  ╫╫╫░░███████▄▄                                        ,╔╗╫╫╫╫╫╫╫╫╫╫╫
                  ╫╫╫╫╫╫╫░░███████▄▄                                 ,╔╗╫╫╫╫╫╫╫╫╫╫╫╫╫╫
                  *╫╫╫╫╫╫╫╫╫╫░░███████▄▄                          ,╔╗╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╛
                   ╟╫╫╫╫╫╫╫╫╫╫╫╫╫░░███████▄▄▄                  ,╔╗╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╛
                   *╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫░░████████▄▄▄          ,╔╗╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫
                    ╟╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫░░█████████▄▄▄▄ ,╔╗╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╛
                    *╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫░░████████╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╛
                     ╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫██░╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╛
                     *╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫░░╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫
                      ╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫░╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╛
                      ╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫░░╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫
                      *╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫░╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╛
                       ╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫░░╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫
                       *╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫██░╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╛
                        ╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫███████░░╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╛
                        *╫╫╫╫╫╫╫╫╫╫╫████████████░╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫
                         ╫╫╫╫╫╫╫╫████████████████▀▀▀ └╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫╛
                         *╫╫╫╫██████████████▀▀             └╣╫╫╫╫╫╫╫╫╫╫╫╫╫╫╫
                          ╫╫██████████▀▀                      └╫╫╫╫╫╫╫╫╫╫╫╫╛
                          *╫████▀▀                                 └╫╫╫╫╬╫╛
```

<div align="center">

# MATRIX EVM Contracts

</div>

<div align="center">

[![Tests](https://github.com/matrixesports/evm-contracts/actions/workflows/tests.yml/badge.svg)](https://github.com/matrixesports/evm-contracts/actions/workflows/tests.yml)

</div>

## Getting started

### Instalation

```bash
make install
```

### Development

-   `main` branch is for production only. Changes are merged if all FE integrations and contract tests pass.
-   Use feature branches for all other changes.
-   This project uses [Foundry](https://getfoundry.sh). See the [book](https://book.getfoundry.sh/getting-started/installation.html) for instructions on how to install and use Foundry.

## Contracts

1. Each creator gets their own `BattlePass` contract.
2. One crafting contract is deployed per network.
3. We use oz's EIP-2771 implementation to enable gasless transactions for our users. We do not verify signatures as of this moment because we use magic wallet on our front end and tx can be signed without users approval as it is, running a verifier would be a bit redundant for now.

### BattlePass

-   Battle Pass is a system that rewards users for completing creator-specific quests during established periods known as `seasons`. Experience points or `xp` tracks user progression. The mechanism is similar to the one used in games.
-   The contract is responsible for storing level information, tracking user progress, and minting rewards upon level completion.
-   There can be multiple seasons in 1 BattlePass
-   The BattlePass can give minting/burning privileges by whitelisting contracts
-   Rewards can be of the following types:
    -   `PREMIUM_PASS`: A user who owns a premium pass can claim premium rewards
    -   `CREATOR_TOKEN`: Creator-specific token associated with the BattlePass
    -   `LOOTBOX`: Defined by a list of reward options. A user gets one of the reward options upon opening a lootbox.
    -   `REDEEMABLE`: These require actions from the creators in real life or online, for ex: ship merch, follow back on twitter, etc.
    -   `SPECIAL`: Custom assets, such as one-of-one NFTs, in-game assets, etc.

### Crafting

-   Allows users to `craft` new tokens based on a `recipe`.
-   The recipe defines a list of input tokens, known as ingredients, and a list of output tokens. Crafting is then the act of burning the input tokens and minting the output tokens.
-   Crafting uses ONLY items from Battle Pass contracts and must be whitelisted by all BattlePass for minting rights.

## Important

-   submodules:
    -   solmate, forge-std works fine with forge update
    -   need to keep an eye on oz, master branch is dev branch, works on release branches, current version installed is v4.6.0. https://github.com/foundry-rs/foundry/issues/401
-   erc20 token takes decimals into account, so to give nice whole numbers, account for that

## Acknowledgements

-   Repo structure heavily inspired by [solmate](https://github.com/Rari-Capital/solmate), [femplate](https://github.com/abigger87/femplate), [foundry](https://github.com/foundry-rs/forge-template)
